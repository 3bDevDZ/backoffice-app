{% extends "base.html" %}

{% block title %}{{ _('Supplier Invoice') }} #{{ invoice.number }} - CommerceFlow{% endblock %}

{% block page_title %}{{ _('Supplier Invoice') }} #{{ invoice.number }}{% endblock %}
{% block page_subtitle %}{{ _('View invoice details') }}{% endblock %}

{% block content %}
<div class="max-w-6xl mx-auto space-y-6">
    <!-- Invoice Header -->
    <div style="background: var(--color-bg-secondary); border: 1px solid var(--color-border-default); border-radius: var(--radius-xl); padding: var(--spacing-lg); box-shadow: var(--shadow-md);">
        <div class="flex items-center justify-between mb-4">
            <div>
                <h3 class="text-lg font-bold">{{ _('Invoice Information') }}</h3>
                <p class="text-sm text-gray-600">{{ _('Status') }}: 
                    {% if invoice.status == 'pending' %}
                    <span class="px-2 py-1 bg-yellow-100 text-yellow-800 text-xs font-medium rounded-full">{{ _('Pending') }}</span>
                    {% elif invoice.status == 'matched' %}
                    <span class="px-2 py-1 bg-green-100 text-green-800 text-xs font-medium rounded-full">{{ _('Matched') }}</span>
                    {% elif invoice.status == 'paid' %}
                    <span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded-full">{{ _('Paid') }}</span>
                    {% endif %}
                </p>
            </div>
            <div class="flex {% if direction == 'rtl' %}space-x-reverse space-x-2{% else %}space-x-2{% endif %}">
                {% if invoice.matching_status != 'matched' %}
                <form method="POST" action="{{ url_for('purchases_frontend.match_supplier_invoice', invoice_id=invoice.id) }}" class="inline">
                    <select name="purchase_order_id" required class="modern-input">
                        <option value="">{{ _('Select Purchase Order') }}</option>
                        <!-- Purchase orders will be loaded here -->
                    </select>
                    <button type="submit" class="btn-primary">{{ _('Match Invoice') }}</button>
                </form>
                {% endif %}
                <a href="{{ url_for('purchases_frontend.list_supplier_invoices') }}" class="btn-secondary">{{ _('Back to List') }}</a>
            </div>
        </div>

        <div class="grid grid-cols-2 gap-4">
            <div>
                <label class="text-sm font-medium text-gray-600">{{ _('Supplier') }}</label>
                <p class="text-gray-900">{{ invoice.supplier_name or '-' }}</p>
            </div>
            <div>
                <label class="text-sm font-medium text-gray-600">{{ _('Invoice Date') }}</label>
                <p class="text-gray-900">{{ invoice.invoice_date.strftime('%Y-%m-%d') if invoice.invoice_date else '-' }}</p>
            </div>
            <div>
                <label class="text-sm font-medium text-gray-600">{{ _('Due Date') }}</label>
                <p class="text-gray-900">{{ invoice.due_date.strftime('%Y-%m-%d') if invoice.due_date else '-' }}</p>
            </div>
            <div>
                <label class="text-sm font-medium text-gray-600">{{ _('Total (TTC)') }}</label>
                <p class="text-gray-900 font-bold">{{ invoice.total_ttc|to_float|currency }}</p>
            </div>
            {% if matched_po %}
            <div class="col-span-2">
                <label class="text-sm font-medium text-gray-600">{{ _('Matched Purchase Order') }}</label>
                <p class="text-gray-900">{{ matched_po.number }}</p>
            </div>
            {% endif %}
            {% if invoice.notes %}
            <div class="col-span-2">
                <label class="text-sm font-medium text-gray-600">{{ _('Notes') }}</label>
                <p class="text-gray-900">{{ invoice.notes }}</p>
            </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}


